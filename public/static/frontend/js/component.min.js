var DEFAULT_BRANDID=10001,oneMenuHeight=51,twoMenuWidth=180,threeMenuHeight=75,avatarHeight=84,winHeight=$(window).height(),winWidth=$(window).width();function computeRollPage(e,t,a){var i=new Array;if(0<e){e=t<e?t:e-1;var n=Math.ceil(a+1-e/2);1<n?t-e<n&&(n=t<=e?1:t-e):n=1;for(var r=n,l=n;l<e+n;l++)l<t&&r++}var s=0;for(l=n;l<=r;l++)i[s]=l,s++;return i}function alertModal(e){var t=1e3+e.length/5*1e3;$("#alertModal").find(".modal-body").html(e),$("#alertModal").modal("show"),setTimeout(function(){$("#alertModal").modal("hide")},t)}function getParams(){var e=location.href,t=(e=e.substring(e.lastIndexOf("?")+1)).split("&"),a={},n="",r="",l="";for(i=0;i<t.length;i++)r=(n=t[i].split("="))[0],l=n[1],a[r]=l;return a}function basicRequest(e){var n=new Vue({mixins:[{el:"",data:function(){return{queryUrl:"",queryParam:{},entities:[],delUrl:"",delArr:[],delTitle:"",delAlertText:"",setUrl:"",addTitle:"",editTitle:"",entity:{},defaultEntity:{},switchUrl:"",switchArr:[],queryPageUrl:"",totalElements:0,totalPages:0,numberOfElements:0,last:!0,first:!0,rollPageArray:[],rollpage:5}},mounted:function(){this.$nextTick(function(){$("#my_content").css({width:winWidth-twoMenuWidth-30,height:winHeight-oneMenuHeight-threeMenuHeight,top:oneMenuHeight+threeMenuHeight,left:twoMenuWidth+15}),$("#bottom_groupbtn").width($("#table_parrent").width()),$("#my_content").scroll(function(e){$("#bottom_groupbtn").width($("#table_parrent").width())}),$("#setModal input").keydown(function(e){13==e.which&&$("#setBtn").trigger("click")}),$("#queryBox input").keydown(function(e){13==e.which&&$("#queryBtn").trigger("click")}),$("#my_content").on("focus",".disabledInput",function(e){$(this).blur()}),this.queryUrl&&this.queryAction(),this.queryPageUrl&&this.queryPageAction()})},methods:{useSelect:function(e){"yes"!=$(e.currentTarget).data("select")?($(e.currentTarget).select(),$(e.currentTarget).data("select","yes")):$(e.currentTarget).data("select","no")},selectAll:function(e){$(e.currentTarget).get(0).checked?($(".chooseArrClass").each(function(e,t){$(t).get(0).checked=!0}),$(".selectAll").each(function(e,t){$(t).get(0).checked=!0})):($(".chooseArrClass").each(function(e,t){$(t).get(0).checked=!1}),$(".selectAll").each(function(e,t){$(t).get(0).checked=!1}))},defaultSelect:function(){$(".chooseArrClass").each(function(e,t){$(t).get(0).checked=!1}),$(".selectAll").each(function(e,t){$(t).get(0).checked=!1})},queryAction:function(){$.ajax({url:n.queryUrl,type:"GET",dataType:"json",data:n.queryParam}).done(function(e){"000000"==e.resp_code?n.entities=e.resp_result:e.resp_msg&&alertModal(e.resp_msg)})},queryPageAction:function(){$.ajax({url:n.queryPageUrl,type:"GET",dataType:"json",data:n.queryParam}).done(function(e){"000000"==e.resp_code?(n.entities=e.resp_result.content,n.totalElements=e.resp_result.totalElements,n.totalPages=e.resp_result.totalPages,n.queryParam.page=e.resp_result.number,n.numberOfElements=e.resp_result.numberOfElements,n.queryParam.size=e.resp_result.size,n.last=e.resp_result.last,n.first=e.resp_result.first,n.rollPageArray=computeRollPage(n.rollpage,n.totalPages,n.queryParam.page)):(n.entities=e.resp_result,e.resp_msg&&alertModal(e.resp_msg))})},setAction:function(){n.preSetAction()&&$.ajax({url:n.setUrl,type:"POST",dataType:"json",data:n.entity}).done(function(e){"000000"==e.resp_code&&(n.queryPageUrl?n.queryPageAction():n.queryAction(),$("#setModal").modal("hide")),alertModal(e.resp_msg)})},preSetAction:function(){return!0},delAction:function(){null==n.delArr||n.delArr.length<=0||$.ajax({url:n.delUrl,type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(n.delArr)}).done(function(e){$("#delModal").modal("hide"),"000000"==e.resp_code?(n.queryPageUrl?n.queryPageAction():n.queryAction(),n.defaultSelect()):alertModal(e.resp_msg)})},switchAction:function(t){null==n.switchArr||n.switchArr.length<=0||$.ajax({url:n.switchUrl,type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(n.switchArr)}).done(function(e){switch(n.queryPageUrl?n.queryPageAction():n.queryAction(),t){case"single":"000000"!=e.resp_code&&alertModal(e.resp_msg);break;case"batch":alertModal(e.resp_msg),n.defaultSelect()}})},prev:function(){n.first||(n.queryParam.page=n.queryParam.page-1,n.queryPageAction())},next:function(){n.last||(n.queryParam.page=n.queryParam.page+1,n.queryPageAction())},firstpage:function(){n.first||(n.queryParam.page=0,n.queryPageAction())},lastpage:function(){n.last||(n.queryParam.page=n.totalPages-1,n.queryPageAction())},skip:function(e){0<e&&e<=n.totalPages&&(n.queryParam.page=e-1,n.queryPageAction())},setSize:function(e){n.queryParam.size=e,n.queryParam.page=0,n.queryPageAction()},add:function(){var e={};for(var t in n.defaultEntity)e[t]=n.defaultEntity[t];n.entity=e,$("#setModalLabel").html(n.addTitle),$("#setModal").modal("show")},edit:function(e){var t={};for(var a in n.defaultEntity)null!=e[a]?t[a]=e[a]:t[a]="";n.entity=t,$("#setModalLabel").html(n.editTitle),$("#setModal").modal("show")},del:function(e){var t=new Array;t.push(e.id),n.delArr=t,$("#delModal").modal("show")},batchDel:function(){var a=new Array;$(".chooseArrClass").each(function(e,t){$(t).get(0).checked&&a.push($(t).val())}),n.delArr=a,null!=n.delArr&&0<n.delArr.length&&$("#delModal").modal("show")},switchSingle:function(e){var t=new Array;t.push({id:e.id,enabled:!e.enabled}),n.switchArr=t,n.switchAction("single")},switchBatch:function(a){var i=new Array;$(".chooseArrClass").each(function(e,t){$(t).get(0).checked&&i.push({id:$(t).val(),enabled:a})}),n.switchArr=i,n.switchAction("batch")},uniqueInput:function(){n.queryParam={}},filterEnabled:function(e){return e?"./images/open.png":"./images/close.png"},filterStatusClass:function(e){return e?"":"c_danger"}}}],el:e.el,data:function(){return e.data},mounted:e.mounted,methods:e.methods});return n}$.ajaxSetup({crossDomain:!0,xhrFields:{withCredentials:!0}}),Vue.component("my-header",{props:["uri"],template:'    <div>        \x3c!-- 一级菜单 --\x3e        <div class="container-fluid oneMenum p0">            <div class="row bg4 m0">                <div class="col-sm-3 col-md-2 hidden-xs pl0 pr0 bg_white" style="width:200px;">                    <a class="dbk backend_logo" href="./personAccountInfo.html">                        <img id="logoimg" class="center-block" src="./images/logo.png" height="40" >                    </a>                </div>                <div v-for="item in onemenu" class="col-sm-1 pl0 pr0">                    <a class="pt15 pb15 text-center dbk" :class=\'isCurrent(item.current)\' :href=\'item.uri\'>{{ item.name }}</a>                </div>                <div class="oneMenum_right clearfix">                    <a href="#" title="消息提醒" class="pull-left bl1 porel" id="getMessageBtn" style="padding:12px 15px 11px;">                        <img src="./images/bell.png" height="28">                        <span class="bg_warning text-center dno" style="width:8px;height:8px;line-height:8px;border-radius:4px;position:absolute;right:20px;top:12px;" id="getMessageBtnContent"></span>                    </a>                    <a href="./accountBasicInfo.html" title="个人信息" class="pull-left bl1" style="padding:12px 17px 11px;">                        <img src="./images/ownInfo.png" height="28">                    </a>                    <a @click="refreshCache" title="更新缓存" href="javascript:void(0);" class="pull-left bl1" style="padding:12px 15px 11px;">                        <img src="./images/refreshCache.png" height="28">                    </a>                    <a @click="logout" title="退出登录" href="javascript:void(0);" class="pull-left bl1" style="padding:12px 15px 11px;">                        <img src="./images/exit.png" height="28">                    </a>                </div>            </div>        </div>        <div class="clearfix top_padding"></div>        \x3c!-- 二级菜单 --\x3e        <div id="twoMenum_box" class="twoMenum_box bg1 pull-left">            <div class="bg5 pt15 pb15 pl10 pr10 clearfix">                <a class="pull-left" href="./personAccountInfo.html">                    <img height="54" src="./images/headshot.png">                </a>                <div class="pull-left ml5 f12">                    <p class="c_white ofh" style="width:101px;white-space:nowrap;">                        {{ user.phone }}                    </p>                    <p class="c_white ofh" :title="roleName()" style="width:101px;white-space:nowrap;">                        {{ roleName() }}                    </p>                    <p class="ofh" style="width:101px;white-space:nowrap;height:16px;line-height:16px;">                        <a class="c_three" title="修改密码" href="./accountPassword.html">                            <img src="./images/safe.png" height="16">                        </a>                    </p>                </div>            </div>            <div id="twoMenum" class="twoMenum">                <template v-for="item in twomenu">                    <a class="dbk pt10 pb10 pl20" :class=\'isCurrent(item.current)\' :href="item.uri">                        <img height="20" :src="item.icon"> <span>{{ item.name }}</span>                    </a>                </template>            </div>        </div>        \x3c!-- 三级菜单 --\x3e        <div id="threeMenu_box" class="threeMenu_box bg_gray">            \x3c!-- 可添加类：横向等宽nav-justified，垂直堆叠nav-stacked，将nav-pills改为nav-tabs可更换成标签页 --\x3e            <ul class="nav nav-pills p15 mt15 ml15 mr15 dsbb1 bg_white">                <template v-for="item in threemenu">                    <li role="presentation" :class="isActive(item.current)">                        <a :href=\'item.uri\'>{{ item.name }}</a>                    </li>                </template>            </ul>        </div>        \x3c!-- 加载中 --\x3e        <div id="loading" class="loading-box hidden">            <div class="css3-loading-shade"></div>            <div class="css3-loading-box">                <div class="text-center" id="loadingBody">{{ loadingText }}</div>                <div class="css3-loading">                    <div class="bounce1"></div>                    <div class="bounce2"></div>                    <div class="bounce3"></div>                </div>            </div>        </div>        \x3c!-- alert提示框 --\x3e        <div class="modal fade" id="alertModal" tabindex="-1" role="dialog" aria-labelledby="alertModalLabel" aria-describedby="提示信息">            <div class="modal-dialog" aria-hidden="true" style="width:388px;margin-top:65px;">                <div class="modal-content c_white" style="border:0;background:#000000;">                    <div class="modal-body text-center"></div>                </div>            </div>        </div>    </div>    ',data:function(){return{myuri:this.uri,onemenu:[],twomenu:[],threemenu:[],user:{},loadingText:"银钱包"}},mounted:function(){this.$nextTick(function(){$("#twoMenum_box").css("height",winHeight-oneMenuHeight),$("#twoMenum").css("height",winHeight-oneMenuHeight-avatarHeight),$("#threeMenu_box").css({width:winWidth-twoMenuWidth,height:winHeight-oneMenuHeight,left:twoMenuWidth,top:oneMenuHeight}),$("#alertModal").css("z-index","9999"),$(document).ajaxStart(function(){$("#loading").removeClass("hidden")}),$(document).ajaxStop(function(){$("#loading").addClass("hidden")});var t=this;$.ajax({url:ROUTE10028,type:"GET",dataType:"json",data:{uri:t.myuri}}).done(function(e){"000000"==e.resp_code?(t.onemenu=e.resp_result.onemenu,t.twomenu=e.resp_result.twomenu,t.threemenu=e.resp_result.threemenu,t.user=e.user):(alertModal(e.resp_msg),setTimeout(function(){window.location.href="./login.html"},2200))})})},methods:{roleName:function(){if(null==this.user.roles||this.user.roles.length<=0)return"超管";for(var e="",t=0;t<this.user.roles.length;t++)e+=this.user.roles[t].name+",";return e.substring(0,e.length-1)},isCurrent:function(e){return e?"current":""},isActive:function(e){return e?"active":""},refreshCache:function(){$.ajax({url:ROUTE10005,type:"GET",dataType:"json",data:{}}).done(function(e){alertModal(e.resp_msg),setTimeout(function(){location.reload(!0)},2e3)})},logout:function(){$.ajax({url:ROUTE10006,type:"GET",dataType:"json",data:{}}).done(function(e){alertModal(e.resp_msg),setTimeout(function(){location.href="./login.html"},2e3)})}}});